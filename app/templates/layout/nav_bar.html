<script>
  document.addEventListener('DOMContentLoaded', () => {
    const path = window.location.pathname
    const cartBtn = document.getElementById('cart')
    if(cartBtn.getAttribute("href") === path){
      cartBtn.classList.add('d-none')
    }else{
      cartBtn.classList.remove('d-none')
    }
  })

</script>

<nav class="navbar navbar-success bg-light vh-10 p-3">
  <div class="container">
    <a class="navbar-brand" href="/">Cartopia</a>
    <div>
      <a type="button" id="cart" class="btn btn-light position-relative me-3" href="/cart">
        <i class="bi bi-bag"></i>
          <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
            {{total_qty}}
          </span>
      </a>
      {% if token %}
        <a class="btn btn-light" onclick="handleLogout('{{token}}')"><i class="bi bi-box-arrow-right"></i></a>
      {% endif %}
    </div>
  </div>
</nav>
<script>
  const handleLogout = async (token) => {
    const response = await fetch('/api/auth/logout', {
      method: "POST",
      headers: {
        'Authorization': `Bearer ${token}`
      }
    });
    const {detail, success} = await response.json();
    showToast(detail, success, '/login')
  }
</script>